webpackJsonp([9],{"1/oy":function(t,e){},"9M+g":function(t,e){},GfHa:function(t,e){},"HT+b":function(t,e){},Id91:function(t,e){},Jmt5:function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={};n.d(r,"signInWith",function(){return ut}),n.d(r,"signOut",function(){return st}),n.d(r,"checkUser",function(){return it}),n.d(r,"fbGet",function(){return ot}),n.d(r,"fbPost",function(){return ct}),n.d(r,"fbUpdate",function(){return pt}),n.d(r,"fbDelete",function(){return ft}),n.d(r,"fbQuery",function(){return lt});var a=n("7+uW"),u=n("Dd8w"),s=n.n(u),i=n("/ocq");a.a.use(i.a);var o=["testComponent1","NumPad","cart","ItemCard","checkout","CustomList"],c=[{key:"ItemOrder",name:"點餐介面"},{key:"Settings",name:"設定"}],p=function(){return n.e(3).then(n.bind(null,"1sVE"))},f=function(){return n.e(0).then(n.bind(null,"RZGl"))},l=function(){return n.e(0).then(n.bind(null,"COBD"))},h=function(){return Promise.all([n.e(0),n.e(5)]).then(n.bind(null,"n7mW"))},m=function(){return Promise.all([n.e(0),n.e(6)]).then(n.bind(null,"N4Va"))},d=function(){return n.e(0).then(n.bind(null,"RFjD"))},b=function(){return n.e(4).then(n.bind(null,"Cw/C"))},v=function(){return Promise.all([n.e(0),n.e(1)]).then(n.bind(null,"3gIu"))},S=function(){return Promise.all([n.e(0),n.e(7)]).then(n.bind(null,"lFos"))},E=function(){return Promise.all([n.e(0),n.e(2)]).then(n.bind(null,"LD5S"))};var _=new i.a({routes:[{path:"/",component:E},{path:"/testComponent1",component:p},{path:"/NumPad",component:f},{path:"/cart",component:l},{path:"/ItemCard",component:h},{path:"/ItemTable",component:b},{path:"/ItemOrder",component:v},{path:"/checkout",component:m},{path:"/CartsTable",component:S},{path:"/CustomList",component:d},{path:"/Settings",component:E}]}),x=n("NYxO"),T={name:"navibar",data:function(){return{components:o,pages:c}},mounted:function(){this.init()},computed:s()({},Object(x.d)(["userInformation","alertSuccess"])),methods:s()({},Object(x.b)(["signInWith","signOut","checkUser"]),{init:function(){var t=this;setTimeout(function(){t.checkUser()},2e3)}})},g={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-navbar",{attrs:{fixed:"top",variant:"light",sticky:""}},[void 0!==t.userInformation?n("b-navbar-nav",{staticClass:"mr-auto"},[t.userInformation.shopId?n("b-dropdown",{attrs:{id:"ddown-left",text:"功能表"}},t._l(t.pages,function(e){return n("b-dropdown-item",{key:e.key,attrs:{to:"/"+e.key}},[t._v("\n        "+t._s(e.name)+"\n      ")])})):t._e()],1):t._e(),t._v(" "),Boolean(t.alertSuccess)?n("b-navbar-nav",[n("b-alert",{attrs:{show:""}},[t._v(t._s(t.alertSuccess))])],1):n("b-navbar-nav",{staticClass:"ml-auto"},[void 0===t.userInformation?n("b-nav-item",[n("b-button",{attrs:{variant:"outline-success"},on:{click:function(e){t.signInWith("google")}}},[t._v("Google登入")]),t._v(" "),n("b-button",{on:{click:function(e){t.signInWith("anon")}}},[t._v("匿名登錄")])],1):n("b-nav-item",[t._v("\n      "+t._s(t.userInformation.displayName)+"\n      "),n("b-button",{attrs:{variant:"outline-danger"},on:{click:function(e){t.signOut()}}},[t._v("登出")])],1)],1)],1)},staticRenderFns:[]},k={name:"App",components:{navibar:n("VU/8")(T,g,!1,null,null,null).exports},computed:s()({},Object(x.d)(["userInformation"]))},I={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("navibar"),this._v(" "),void 0!==this.userInformation?e("router-view"):this._e()],1)},staticRenderFns:[]};var A,w,O=n("VU/8")(k,I,!1,function(t){n("HT+b")},null,null).exports,C=n("bOdI"),y=n.n(C),U=n("d7EF"),R=n.n(U),P=(A={},y()(A,"SET_DATA",function(t,e){var n=R()(e,2),r=n[0],a=n[1];t[r]=a}),y()(A,"SET_ALERTSUCCESS",function(t,e){t.alertSuccess=e,setTimeout(function(){t.alertSuccess=null},5e3)}),y()(A,"SET_ALERTMESSAGE",function(t,e){t.alertMessage=e,setTimeout(function(){t.alertMessage=null},5e3)}),y()(A,"SET_USERINFO",function(t,e){t.userInformation=e,t.login=void 0!==e}),y()(A,"CHECKOUT_ITEM",function(t,e){var n=t.cart.findIndex(function(t){return t.name===e.name&&t.specials_id===e.specials_id});-1==n?t.cart.push(e):t.cart[n].number=parseInt(e.number,10)+parseInt(t.cart[n].number,10)}),y()(A,"CHECKOUT_CART",function(t){t.cart=[]}),y()(A,"CASHIER_RESPONSE",function(t,e){t.cashierOpened="success"===e}),y()(A,"SET_CARTS",function(t,e){var n=R()(e,2),r=n[0];n[1];r.forEach(function(t){t.items.forEach(function(t){t.specials||(t.specials=[])})}),t.carts=r}),y()(A,"REMOVE_CART",function(t,e){var n=t.carts.findIndex(function(t){return t.id===e});-1!==n&&t.carts.splice(n,1)}),y()(A,"SET_SHOPS",function(t,e){var n=R()(e,2),r=n[0];n[1];t.shops=r}),A),F=n("pFYg"),L=n.n(F),N=n("Xxa5"),M=n.n(N),D=n("woOf"),G=n.n(D),W=n("exGp"),j=n.n(W),H=n("fZjL"),V=n.n(H),z=n("Zrlr"),J=n.n(z),K=n("yviF"),Y=n.n(K),Z=(n("dih4"),n("881v"),w={config:{apiKey:"AIzaSyCxDUSrjbv_vMEica-94tY_k5N8pOkepVM",authDomain:"authtest-4b972.firebaseapp.com",databaseURL:"https://authtest-4b972.firebaseio.com",projectId:"authtest-4b972"}}.config,Y.a.initializeApp(w),Y.a);Z.firestore().settings({timestampsInSnapshots:!0});var B,Q,$,q,X,tt,et,nt=this,rt=new function t(){J()(this,t),this.ref=function(t){return t.split("/").reduce(function(t,e,n){return(1+n)%2?t.collection(e):t.doc(e)},Z.firestore())},this.timestamp=function(){return Z.firestore.FieldValue.serverTimestamp()},this.propDelete=function(){return Z.firestore.FieldValue.delete()}},at=new function t(){var e=this;J()(this,t),this.setPersistence=function(t){return e.auth.setPersistence(Z.auth.Auth.Persistence[t])},this.authWithGoogle=function(){return e.auth.signInWithPopup(e.provider)},this.authWithAnon=function(){return e.auth.signInAnonymously()},this.signOut=function(){return e.auth.signOut()},this.getUser=function(){return e.auth.currentUser},this.filterUserInfo=function(t){var e=["uid","displayName","photoURL","email"];return V()(t).filter(function(t){return e.includes(t)}).reduce(function(e,n){return e[n]=t[n],e},{})},this.provider=new Y.a.auth.GoogleAuthProvider,this.auth=Z.auth()},ut=function(){var t=j()(M.a.mark(function t(e,n){var r,a,u,s,i=e.commit;return M.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r=null,a=null,u=null,!0!==it({})){t.next=6;break}return t.abrupt("return");case 6:t.t0=n,t.next="google"===t.t0?9:"anon"===t.t0?13:17;break;case 9:return t.next=11,at.authWithGoogle();case 11:return r=t.sent,t.abrupt("break",18);case 13:return t.next=15,at.authWithAnon();case 15:return r=t.sent,t.abrupt("break",18);case 17:return t.abrupt("return");case 18:if(!r){t.next=25;break}return a=at.filterUserInfo(r.user),at.setPersistence("LOCAL"),t.next=23,ot({},["users/"+r.user.uid]);case 23:(u=t.sent)?i("SET_USERINFO",u):(s=G()(a,{identity:null}),ct({},["users/"+s.uid,s]).then(function(){i("SET_USERINFO",s)}));case 25:t.next=30;break;case 27:t.prev=27,t.t1=t.catch(0),i("SET_ALERTMESSAGE",t.t1);case 30:case"end":return t.stop()}},t,nt,[[0,27]])}));return function(e,n){return t.apply(this,arguments)}}(),st=(B=j()(M.a.mark(function t(e){var n=e.commit;return M.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.t0=n,t.next=4,at.signOut();case 4:t.t1=t.sent,(0,t.t0)("SET_USERINFO",t.t1),n("SET_DATA",["items",[]]),n("SET_DATA",["carts",[]]),n("SET_DATA",["my_shop",null]),t.next=14;break;case 11:t.prev=11,t.t2=t.catch(0),n("SET_ALERTMESSAGE",t.t2);case 14:case"end":return t.stop()}},t,nt,[[0,11]])})),function(t){return B.apply(this,arguments)}),it=(Q=j()(M.a.mark(function t(e){var n,r=e.commit;return M.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,null===at.getUser()){t.next=10;break}return t.next=4,ot({},["users/"+at.getUser().uid]);case 4:return n=t.sent,r("SET_USERINFO",n),null!==n.shopId&&ot({commit:r},["shops/"+n.shopId,"my_shop"]),t.abrupt("return",!0);case 10:return t.abrupt("return",!1);case 11:t.next=17;break;case 13:t.prev=13,t.t0=t.catch(0),r("SET_ALERTMESSAGE",t.t0),console.error(t.t0);case 17:case"end":return t.stop()}},t,nt,[[0,13]])})),function(t){return Q.apply(this,arguments)}),ot=($=j()(M.a.mark(function t(e,n){var r,a=e.commit,u=R()(n,2),s=u[0],i=u[1];return M.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r=null,"object"!==(void 0===s?"undefined":L()(s))){t.next=8;break}return t.next=5,s.get();case 5:r=t.sent,t.next=11;break;case 8:return t.next=10,rt.ref(s).get();case 10:r=t.sent;case 11:if(!r){t.next=20;break}if(r=ht(r),!i){t.next=17;break}a("SET_DATA",[i,r]),t.next=18;break;case 17:return t.abrupt("return",r);case 18:t.next=21;break;case 20:return t.abrupt("return",null);case 21:t.next=26;break;case 23:return t.prev=23,t.t0=t.catch(0),t.abrupt("return",t.t0);case 26:case"end":return t.stop()}},t,nt,[[0,23]])})),function(t,e){return $.apply(this,arguments)}),ct=(q=j()(M.a.mark(function t(e,n){e.commit;var r,a=R()(n,2),u=a[0],s=a[1];return M.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r=rt.ref(u),G()(s,{date:rt.timestamp()}),!("set"in r)){t.next=7;break}return t.abrupt("return",r.set(s));case 7:return t.abrupt("return",r.add(s));case 8:t.next=13;break;case 10:return t.prev=10,t.t0=t.catch(0),t.abrupt("return",t.t0);case 13:case"end":return t.stop()}},t,nt,[[0,10]])})),function(t,e){return q.apply(this,arguments)}),pt=(X=j()(M.a.mark(function t(e,n){var r,a,u=e.commit,s=R()(n,2),i=s[0],o=s[1];return M.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(r in t.prev=0,o.roles)"fb.firestore.FieldValue.delete"===o.roles[r]&&(o.roles[r]=rt.timestamp());return G()(o,{last_update:rt.timestamp()}),t.next=5,rt.ref(i).update(o);case 5:return void 0===(a=t.sent)&&u("SET_ALERTSUCCESS","更新成功"),t.abrupt("return",a);case 10:return t.prev=10,t.t0=t.catch(0),t.abrupt("return",t.t0);case 13:case"end":return t.stop()}},t,nt,[[0,10]])})),function(t,e){return X.apply(this,arguments)}),ft=(tt=j()(M.a.mark(function t(e,n){var r,a=e.commit,u=R()(n,1)[0];return M.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,rt.ref(u).delete();case 3:return void 0===(r=t.sent)&&a("SET_ALERTSUCCESS","刪除成功"),t.abrupt("return",r);case 8:return t.prev=8,t.t0=t.catch(0),t.abrupt("return",t.t0);case 11:case"end":return t.stop()}},t,nt,[[0,8]])})),function(t,e){return tt.apply(this,arguments)}),lt=(et=j()(M.a.mark(function t(e,n){var r,a=e.commit,u=R()(n,3),s=u[0],i=u[1],o=u[2];return M.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=i.split("_"),t.next=3,rt.ref(s).where(i[0],i[1],i[2]);case 3:if(!(r=t.sent)){t.next=8;break}return t.abrupt("return",ot({commit:a},[r,o]));case 8:return t.abrupt("return",null);case 9:case"end":return t.stop()}},t,nt)})),function(t,e){return et.apply(this,arguments)}),ht=function(t){if("docs"in t){var e=[];t.forEach(function(t){var n=t.data();n.id=t.id,e.push(n)}),t=e}else t=t.exists?t.data():null;return t};a.a.use(x.a);var mt={items:[],cart:[],carts:[],shops:[],my_shop:null,cashierOpened:!1,userInformation:void 0,alertMessage:null,alertSuccess:null,login:null},dt=new x.a.Store({state:mt,mutations:P,actions:r}),bt=n("e6fC");n("Jmt5"),n("9M+g");a.a.use(bt.a),a.a.config.productionTip=!1,new a.a({el:"#app",router:_,store:dt,components:{App:O},template:"<App/>"})},zj2Q:function(t,e){}},["NHnr"]);